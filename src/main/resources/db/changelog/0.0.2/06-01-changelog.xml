<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd"
    objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1638776746723-37" author="Ivan">
        <addUniqueConstraint columnNames="course_name"
                             constraintName="uk_e6rl70tjjnfr7cpqd6koh0abk"
                             tableName="courses"/>
    </changeSet>
    <changeSet id="1638776746723-38" author="Ivan">
        <createIndex indexName="idx_department" tableName="departments">
            <column name="department_name"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-40" author="Ivan">
        <addUniqueConstraint columnNames="faculty_name"
                             constraintName="uk_jrs3jldywwfd0vk743hmoxxn4"
                             tableName="faculties"/>
    </changeSet>
    <changeSet id="1638776746723-44" author="Ivan">
        <createIndex indexName="idx_lesson_time_end" tableName="lessons">
            <column name="time_end"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-45" author="Ivan">
        <createIndex indexName="idx_lesson_time_start" tableName="lessons">
            <column name="time_start"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-47" author="Ivan">
        <createIndex indexName="idx_group_faculty_id" tableName="groups">
            <column name="faculty_id"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-48" author="Ivan">
        <createIndex indexName="idx_group_group_active" tableName="groups">
            <column name="group_active"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-49" author="Ivan">
        <addUniqueConstraint columnNames="group_name"
                             constraintName="uk_7o859iyhxd19rv4hywgdvu2v4"
                             tableName="groups"/>
    </changeSet>
    <changeSet id="1638776746723-50" author="Ivan">
        <createIndex indexName="idx_student_active" tableName="students">
            <column name="active"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-52" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="student_id"
                                 baseTableName="students_lessons"
                                 constraintName="fk_student"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="id"
                                 referencedTableName="students"/>
    </changeSet>
    <changeSet id="1638776746723-54" author="Ivan">
        <createIndex indexName="idx_room_building" tableName="rooms">
            <column name="building"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-55" author="Ivan">
        <createIndex indexName="idx_room_room_number" tableName="rooms">
            <column name="room_number"/>
        </createIndex>
    </changeSet>
    <changeSet id="1638776746723-56" author="Ivan">
        <createSequence cacheSize="1" cycle="false" dataType="bigint"
                        incrementBy="1" maxValue="9223372036854775807"
                        minValue="1" sequenceName="hibernate_sequence"
                        startValue="1"/>
    </changeSet>
    <changeSet id="1638776746723-57" author="Ivan">
        <renameColumn tableName="students"
                      oldColumnName="student_id"
                      newColumnName="id"/>
    </changeSet>
    <changeSet id="1638776746723-58" author="Ivan">
        <renameColumn tableName="students"
                      oldColumnName="student_active"
                      newColumnName="active"/>
    </changeSet>
    <changeSet id="1638776746723-59" author="Ivan">
        <renameColumn tableName="students"
                      oldColumnName="student_first_name"
                      newColumnName="first_name"/>
    </changeSet>
    <changeSet id="1638776746723-60" author="Ivan">
        <renameColumn tableName="students"
                      oldColumnName="student_last_name"
                      newColumnName="last_name"/>
    </changeSet>
    <changeSet id="1638776746723-61" author="Ivan">
        <renameColumn tableName="students"
                      oldColumnName="student_patronymic"
                      newColumnName="patronymic"/>
    </changeSet>
    <changeSet id="1638776746723-62" author="Ivan">
        <renameColumn tableName="teachers"
                      oldColumnName="teacher_id"
                      newColumnName="id"/>
    </changeSet>
    <changeSet id="1638776746723-63" author="Ivan">
        <renameColumn tableName="teachers"
                      oldColumnName="teacher_active"
                      newColumnName="active"/>
    </changeSet>
    <changeSet id="1638776746723-64" author="Ivan">
        <renameColumn tableName="teachers"
                      oldColumnName="teacher_first_name"
                      newColumnName="first_name"/>
    </changeSet>
    <changeSet id="1638776746723-65" author="Ivan">
        <renameColumn tableName="teachers"
                      oldColumnName="teacher_last_name"
                      newColumnName="last_name"/>
    </changeSet>
    <changeSet id="1638776746723-66" author="Ivan">
        <renameColumn tableName="teachers"
                      oldColumnName="teacher_patronymic"
                      newColumnName="patronymic"/>
    </changeSet>

    <changeSet id="1638776746723-67" author="Ivan">
        <dropForeignKeyConstraint baseTableName="students_lessons"
                                  constraintName="fk_students"/>
    </changeSet>

    <changeSet id="1638776746723-1" author="Ivan">
        <dropForeignKeyConstraint baseTableName="lessons"
                                  constraintName="fk_course"/>
    </changeSet>

    <changeSet id="1638776746723-2" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="course_id"
                                 baseTableName="lessons"
                                 constraintName="fk_course" onDelete="NO ACTION"
                                 onUpdate="NO ACTION"
                                 referencedColumnNames="course_id"
                                 referencedTableName="courses"/>

        <createIndex indexName="idx_lesson_course_id" tableName="lessons">
            <column name="course_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="1638776746723-3" author="Ivan">
        <dropForeignKeyConstraint baseTableName="teachers"
                                  constraintName="fk_department"/>
    </changeSet>

    <changeSet id="1638776746723-4" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="department_id"
                                 baseTableName="teachers"
                                 constraintName="fk_department"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="department_id"
                                 referencedTableName="departments"/>
    </changeSet>

    <changeSet id="1638776746723-5" author="Ivan">
        <dropForeignKeyConstraint baseTableName="departments"
                                  constraintName="fk_faculty"/>
    </changeSet>

    <changeSet id="1638776746723-6" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="faculty_id"
                                 baseTableName="departments"
                                 constraintName="fk_faculty"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="faculty_id"
                                 referencedTableName="faculties"/>

        <createIndex indexName="idx_department_faculty_id"
                     tableName="departments">
            <column name="faculty_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="1638776746723-7" author="Ivan">
        <dropForeignKeyConstraint baseTableName="students"
                                  constraintName="fk_group"/>
    </changeSet>

    <changeSet id="1638776746723-8" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="group_id"
                                 baseTableName="students"
                                 constraintName="fk_group" onDelete="NO ACTION"
                                 onUpdate="NO ACTION"
                                 referencedColumnNames="group_id"
                                 referencedTableName="groups"/>
    </changeSet>

    <changeSet id="1638776746723-9" author="Ivan">
        <dropForeignKeyConstraint baseTableName="students_lessons"
                                  constraintName="fk_lesson"/>
    </changeSet>

    <changeSet id="1638776746723-10" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="lesson_id"
                                 baseTableName="students_lessons"
                                 constraintName="fk_lesson" onDelete="NO ACTION"
                                 onUpdate="NO ACTION"
                                 referencedColumnNames="lesson_id"
                                 referencedTableName="lessons"/>
    </changeSet>

    <changeSet id="1638776746723-11" author="Ivan">
        <dropForeignKeyConstraint baseTableName="lessons"
                                  constraintName="fk_room"/>
    </changeSet>

    <changeSet id="1638776746723-12" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="room_id"
                                 baseTableName="lessons"
                                 constraintName="fk_room" onDelete="NO ACTION"
                                 onUpdate="NO ACTION"
                                 referencedColumnNames="room_id"
                                 referencedTableName="rooms"/>

        <createIndex indexName="idx_lesson_room_id" tableName="lessons">
            <column name="room_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="1638776746723-13" author="Ivan">
        <dropForeignKeyConstraint baseTableName="lessons"
                                  constraintName="fk_teacher"/>
    </changeSet>

    <changeSet id="1638776746723-14" author="Ivan">
        <addForeignKeyConstraint baseColumnNames="teacher_id"
                                 baseTableName="lessons"
                                 constraintName="fk_teacher"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"
                                 referencedColumnNames="id"
                                 referencedTableName="teachers"/>

        <createIndex indexName="idx_lesson_teacher_id" tableName="lessons">
            <column name="teacher_id"/>
        </createIndex>
    </changeSet>

    <changeSet id="1638776746723-15" author="Ivan">
        <modifyDataType columnName="building" newDataType="varchar(100)"
                        tableName="rooms"/>
    </changeSet>

    <changeSet id="1638776746723-16" author="Ivan">
        <modifyDataType columnName="course_id" newDataType="int"
                        tableName="courses"/>
    </changeSet>

    <changeSet id="1638776746723-17" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="course_id"
                          tableName="courses"/>
    </changeSet>

    <changeSet id="1638776746723-18" author="Ivan">
        <modifyDataType columnName="department_id" newDataType="int"
                        tableName="departments"/>
    </changeSet>

    <changeSet id="1638776746723-19" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="department_id"
                          tableName="departments"/>
    </changeSet>

    <changeSet id="1638776746723-20" author="Ivan">
        <modifyDataType columnName="faculty_id" newDataType="int"
                        tableName="faculties"/>
    </changeSet>

    <changeSet id="1638776746723-21" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="faculty_id"
                          tableName="faculties"/>
    </changeSet>

    <changeSet id="1638776746723-22" author="Ivan">
        <modifyDataType columnName="group_id" newDataType="int"
                        tableName="groups"/>
    </changeSet>

    <changeSet id="1638776746723-23" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="group_id"
                          tableName="groups"/>
    </changeSet>

    <changeSet id="1638776746723-24" author="Ivan">
        <modifyDataType columnName="lesson_id" newDataType="int"
                        tableName="lessons"/>
    </changeSet>

    <changeSet id="1638776746723-25" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="lesson_id"
                          tableName="lessons"/>
    </changeSet>

    <changeSet id="1638776746723-26" author="Ivan">
        <modifyDataType columnName="room_id" newDataType="int"
                        tableName="rooms"/>
    </changeSet>

    <changeSet id="1638776746723-27" author="Ivan">
        <dropDefaultValue columnDataType="int" columnName="room_id"
                          tableName="rooms"/>
    </changeSet>

    <changeSet id="1638776746723-28" author="Ivan">
        <modifyDataType columnName="room_number" newDataType="varchar(20)"
                        tableName="rooms"/>
    </changeSet>

    <changeSet id="1638776746723-29" author="Ivan">
        <dropNotNullConstraint columnDataType="timestamp" columnName="time_end"
                               tableName="lessons"/>
    </changeSet>

    <changeSet id="1638776746723-30" author="Ivan">
        <dropNotNullConstraint columnDataType="timestamp"
                               columnName="time_start" tableName="lessons"/>
    </changeSet>

    <changeSet id="1638776746723-32" author="Ivan">
        <addPrimaryKey columnNames="lesson_id, student_id"
                       constraintName="students_lessons_pkey"
                       tableName="students_lessons"/>
    </changeSet>

    <changeSet id="1638776746723-34" author="Ivan">
        <addPrimaryKey columnNames="id" constraintName="students_pkey"
                       tableName="students"/>
    </changeSet>

    <changeSet id="1638776746723-36" author="Ivan">
        <addPrimaryKey columnNames="id" constraintName="teachers_pkey"
                       tableName="teachers"/>
    </changeSet>

</databaseChangeLog>